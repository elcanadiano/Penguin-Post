function validateEmail(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)}function getQuestion(){$.ajax({url:"../donate/postcaptcha.php",type:"POST",dataType:"json",data:{type:"get",questionno:questionno},success:function(a){$("#captcha_question").html(a["question"]);questionno=a["number"]},error:function(a,b,c){$("#postCAPTCHAMessage").html("An error has occured. Please refresh and contact the administrator if this error persists.")}})}function validateCAPTCHA(){var a;if(!using_captcha)return true;else{var b=$("#postCAPTCHA").val().toLowerCase();if(b=="")return false;else{$.ajax({url:"../donate/postcaptcha.php",type:"POST",async:false,dataType:"json",data:{type:"submit",answer:b,questionno:questionno},success:function(b){a=b["success"]},error:function(b,c,d){$("#postCAPTCHAMessage").html("An error has occured. Please refresh and contact the administrator if this error persists.");a=0}})}}return a}function submitEmail(){var a;var b=true;var c=$("#realName").val();var d=$("#emailAddress").val();var e=$("#steamURL").val();var f=$("#steamUsnm").val();var g=$("#donationAmount option:selected").text();var h=$("#message").val();var i="../donate/newemail.php";var j=validateCAPTCHA();if(d==""||!validateEmail(d)){$("#emailAddressMessage").html("Please enter a valid email address.");b=false}else $("#emailAddressMessage").html("");if(e==""){$("#steamURLMessage").html("Please enter a valid Steam URL.");b=false}else $("#steamURLMessage").html("");if(f==""){$("#steamUsnmMessage").html("Please enter a Steam username or name.");b=false}else $("#steamUsnmMessage").html("");if(g=="Select"){$("#donationAmountMessage").html("Please make a selection.");b=false}else $("#donationAmountMessage").html("");if(!j){$("#postCAPTCHAMessage").html("Incorrect answer. A new question has been set forward.");b=false}else $("#postCAPTCHAMessage").html("");if(b){$.ajax({type:"POST",url:"../donate/penguinpost.php",dataType:"json",data:{submit:1,name:c,email:d,steamURL:e,steamUsnm:f,selection:g,message:h},success:function(a){if($("#confirmationBox").hasClass("fail")){$("#confirmationBox").removeClass("fail")}$("#confirmationBox").addClass(a["status"]);$("#confirmationMessage").html(a["message"]);if(a["status"]=="success"){$("#penguinForm").hide(400,function(){$("#confirmationBox").delay(400).fadeIn(500)})}else $("#confirmationBox").fadeIn(500)},error:function(a,b,c){$("#confirmationBox").addClass("fail");$("#confirmationMessage").html("ERROR: The server could not complete the request. Technical Reason: "+c);$("#confirmationBox").fadeIn(500)}})}else{if(using_captcha&&!j){getQuestion()}}}var using_captcha=true;var questionno=-1;$(".close").click(function(){$("#confirmationBox").hide(0,function(){$("#confirmationBox").removeAttr("class")})});$(function(){if(using_captcha){$("#penguinFields").append('<div class="formRow"> <span class="title" id="captcha_question"></span> <input type="text" id="postCAPTCHA" /> <span id="postCAPTCHAMessage" class="error"></span> </div>');getQuestion()}})